import math
import random
import shutil
import os
import numpy as np
import csv

# Biblioteca da seção de choque

filepath1= "/home/users/diegogoncalves/Serpent2/xs/sss_endfb7u.xsdata"
filepath2= "/home/users/diegogoncalves/Serpent2/xs/sss_endfb7.dec"
filepath3= "/home/users/diegogoncalves/Serpent2/xs/sss_endfb7.nfy"
filepath4 = "include"
filepath5 = "/home/diego/Principal/"
filepath6 = "/home/diego/Principal/"
'''
filepath1 = "/home/diego-lenovo/principal/Serpent/xs/sss_endfb7u.xsdata"
filepath2 = "/home/diego-lenovo/principal/Serpent/xs/sss_endfb7.dec"
filepath3 = "/home/diego-lenovo/principal/Serpent/xs/sss_endfb7.nfy"

'''
# Parâmetros neutronicos do modelo
power =160000000
bc = 1
pop = 100000
cyc = 1000
incyc = 100
parts = 50
days=[0.1,1,2,3,5,7,14,21,30,60,90,120,180,240,300,360,420,480,540,600,660,720,780,840]
ind = 0

# Gd2O3 frações somente no elemento C02
gd_fraction=16.0
# Boron concentration in ppm
boron_ppm = 1000
# Pressão em mPa
pressure_mpa = 12.7553
# Temperatura do moderador
temp_mod=600
# Temperatura do combustível
temp_fuel=900

################## Parametros de entrada #################################################
# Enriquecimentos das regiões
enr_a01=(1.500/100)
enr_a02=(1.600/100)
enr_b01=(2.500/100)
enr_b02=(2.600/100)
enr_c01=(4.050/100)
enr_c02=(4.550/100)
enr_c03=(2.600/100)

################## Parâmetros variáveis #################
# largura do elemento combustível
length=21.5033
# Altura total
total_heigth = 243.561

# Diâmetro da vareta combustível físsil (UO2)
radius_fuel = 0.4058

# Espaçamento entre revestimento-combustível
gap = 0.00825

# Espessura do revestimento
clad = 0.06096

# Número de varetas de seed
number_fuel = 17

# Passo do seed
pitch_fuel = (length/number_fuel)

# Altura ativa da parte UOX ou UThOX
heigth_active = 200.000

##### Parâmetros fixos das barras de controle ####

# Espessura suporte superior
top_nozzle = 9.020  # fixo

# Espaçamento de entrada de água
coolant = 8.481  # fixo

# Fim do pino
end_cap = 1.205  # fixo

# Tamanho das molas
plenum_spring = 13.490  # fixo

# Dimensão da mola teórica
spring = 0.0646  # fixo

# Espessura do suporte inferior
bottom_nozzle = 10.160  # fixo

# Número de assemblies
number_assembly = 7  # fixo

# Região vazia da barra de controle
empty_guide = 8.386  # fixo

# Fim da barra de controle
end_plug = 4.859  # fixo

# Tamanho da região de AgInCd
length_aic = 30.480  # fixo

# Comprimento da barra de controle B4C
length_b4c = 157.480  # fixo

# Parte superior da mola da barra de controle
upper_plenum = 23.176  # fixo

# Raio da barra de controle AIC
radius_aic = radius_fuel + 0.0215  # fixo

# Raio da barra de controle B4C
radius_b4c = radius_fuel + 0.0215  # fixo

# Raio do revestimento da barra de controle B4C
radius_bar = radius_fuel + 0.0787  # fixo

# Verificação para pitch_seed e radius_fuel
ratio_fuel = pitch_fuel / (2 * (radius_fuel + gap + clad))

################## Cálculo das dimensões #################
# Comprimento da região de seed
#length = number_fuel * pitch_fuel

# Cálculo de volumes fuel
vol_fuel = (math.pi * radius_fuel ** 2) * heigth_active

# Cálculo de volumes seed subdividida
vol_sub_fuel = (vol_fuel / parts)

# Cálculo de volumes do moderador seed
vol_fuel_mod = heigth_active * (pitch_fuel ** 2) - vol_fuel

# Cálculo de razão vm/vf seed
ratio_vm_vf_fuel = (vol_fuel_mod / vol_fuel)

#### Parâmetros dos refletores e casco ###########

# quadrado do conjunto de ec's
square_barrel=(number_assembly*length)

#raio interno do refletor do nucleo
core_barrel_id=((number_assembly*length))+38.0424

#raio externo do refletor do nucleo
core_barrel_od=core_barrel_id+10.1600

# raio interno vaso de pressão do reator
rpv_id=core_barrel_od+57.7753

# raio externo vaso de pressão do reator
rpv_od=rpv_id+34.4153
# Funções para matrizes
def rg(num):
    if num % 2 == 0:
        return range(-num // 2, num // 2)
    else:
        return range(-num // 2 + 1, num // 2 + 1)

def rm(num):
    if num % 2 == 0:
        return str1(-num // 2) + ":" + str1((num // 2) - 1)
    else:
        return str1(-num // 2 + 1) + ":" + str1(num // 2)

def str_(nl):
    return "{:.4f}".format(nl)

def str1(nl):
    return "{:.3f}".format(nl)

def str2(nl):
    return "{:.2f}".format(nl)

def str0(nl):
    return "{:.0f}".format(nl)

# Transfer file to destination folder
def transfer_file(src_path, dest_path):
    try:
        if not os.path.isfile(src_path):
            raise FileNotFoundError(f"Source file not found: {src_path}")

        if os.path.isdir(dest_path):
            dest_file_path = os.path.join(dest_path, os.path.basename(src_path))
        else:
            dest_file_path = dest_path

        shutil.move(src_path, dest_file_path)
        print(f"File transferred from {src_path} to {dest_file_path}")
    except Exception as e:
        print(f"Error: {e}")

# Writing to CSV file

###################################################################
################ Depletion History ################################
with open("nuscale_"+str(ind)+"h.c", "w",encoding="utf-8") as f:
    f.write("/*** NuScale Reactor ***/\n") 
    f.write("%individuo:"+str(ind)+"\n")
    f.write("%\n")
    f.write("%vol fuel[cm^3]:"+str1(vol_fuel)+"\n")
    f.write("%vol mod.fuel[cm^3]:"+str1(vol_fuel_mod)+"\n")
    f.write("%ratio vm_vf fuel[-]:"+str1(ratio_vm_vf_fuel)+"\n")
    f.write("\n")
    f.write("/****Volumes materials***/\n")
    f.write("include/nuscale_"+str(ind)+"o.c.mvol \n")
    f.write("\n")
    f.write("/****Materials***/\n")
    f.write("include/mat_B4C.inc\n")
    f.write("include/mat_AIC.inc\n")
    f.write("include/mat_inconel625.inc\n")
    f.write("include/mat_ss304.inc\n")
    f.write("include/mat_ss304l.inc\n")
    f.write("include/mat_zircaloy4.inc\n")
    f.write(f"include/mat_water_{temp_mod}K.inc\n")
    f.write("include/mat_helium.inc\n")
    f.write("include/mat_m5.inc\n")
    f.write("include/mat_air.inc\n")
    f.write("include/mat_ss508.inc\n")
    f.write("\n")
    f.write("/****Materials fuels***/\n")
    f.write(f"include/uo_a01_{temp_fuel}K.inc\n")
    f.write(f"include/uo_a02_{temp_fuel}K.inc\n")
    f.write(f"include/uo_b01_{temp_fuel}K.inc\n")
    f.write(f"include/uo_b02_{temp_fuel}K.inc\n")
    f.write(f"include/uo_c01_{temp_fuel}K.inc\n")
    f.write(f"include/uo_c02_{temp_fuel}K.inc\n")
    f.write(f"include/uo_c02g_{temp_fuel}K.inc\n")
    f.write(f"include/uo_c03_{temp_fuel}K.inc\n")
    f.write("\n")
    f.write("/*** Axial surfaces for fuel rods ***/\n")
    f.write("/*** Surface bottom nozzle lower***/\n")
    f.write("surf 1 pz "+str1(-total_heigth/2)+" \n")
    f.write("\n")
    f.write("/*** Surface bottom nozzle top***/\n")
    f.write("surf 2 pz "+str1(-total_heigth/2 + bottom_nozzle)+"\n")
    f.write("\n")
    f.write("/*** Surface end cap top***/\n")
    f.write("surf 3 pz "+str1(-total_heigth/2 + (bottom_nozzle+end_cap))+"\n")
    f.write("\n")
    f.write("/*** Surface UOX***/\n")
    f.write("surf 4 pz "+str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+" \n")
    f.write("\n")
    f.write("/*** Surface plenum spring***/\n")
    f.write("surf 5 pz "+str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active+plenum_spring))+"\n")
    f.write("\n")
    f.write("/*** Surface end cap***/\n")
    f.write("surf 6 pz "+str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active+plenum_spring+end_cap))+" \n")
    f.write("\n")
    f.write("/*** Surface coolant***/\n")
    f.write("surf 7 pz "+str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active+plenum_spring+coolant))+" \n")
    f.write("\n")
    f.write("/*** Surface top nozzle***/\n")
    f.write("surf 8 pz "+str1(total_heigth/2)+"\n")
    f.write("\n")
    f.write("/*** Surface outside Lattice***/\n")
    f.write("surf 9 cuboid "+str_(-(length)/2)+" "+str_((length)/2)+" "+str_(-(length)/2)+" "+str_((length)/2)+" "+str1(-total_heigth/2)+" "+str1(total_heigth/2)+"\n")
    f.write("surf 10 cuboid "+str_(-length/2)+" "+str_(length/2)+" "+str_(-length/2)+" "+str_((length)/2)+" "+str1((-total_heigth)/2-0.05)+" "+str1((total_heigth)/2+0.05)+"\n")
    f.write("\n")
    f.write("/*** Surface outside Lattice***/\n")
    f.write("surf 11 inf\n")
    f.write("\n")
    f.write("/*** Axial surfaces for bar control ***/\n")
    f.write("/*** Surface bottom nozzle lower***/\n")
    f.write("surf 12 pz "+str1(-total_heigth/2)+"\n")
    f.write("\n")
    f.write("/*** Surface bottom nozzle top***/\n")
    f.write("surf 13 pz "+str1(-total_heigth/2 + bottom_nozzle)+"\n")
    f.write("\n")
    f.write("/*** Surface end cap top***/\n")
    f.write("surf 14 pz "+str1(-total_heigth/2 + (bottom_nozzle+end_cap))+"\n")
    f.write("\n")
    f.write("/*** Surface AIC***/\n")
    f.write("surf 15 pz "+str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic)+"\n")
    f.write("\n")
    f.write("/*** Surface plenum spring***/\n")
    f.write("surf 16 pz "+str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic+plenum_spring)+"\n")
    f.write("\n")
    f.write("/*** Surface B4C***/\n")
    f.write("surf 17 pz "+str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic+plenum_spring+length_b4c)+"\n")
    f.write("\n")
    f.write("/*** Surface plenum spring***/\n")
    f.write("surf 18 pz "+str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic+length_b4c+upper_plenum)+"\n")
    f.write("\n")
    f.write("/*** Surface top nozzle***/\n")
    f.write("surf 19 pz "+str1(total_heigth/2)+"\n")
    f.write("\n")
    f.write("/*** Surfaces outside core***/\n")
    f.write("surf 20 cuboid "+str_(-(square_barrel)/2)+" "+str_((square_barrel)/2)+" "+str_(-(square_barrel)/2)+" "+str_((square_barrel)/2)+" "+str1(-total_heigth/2)+" "+str1(total_heigth/2)+" \n")
    f.write("surf 21 cuboid "+str_(-(square_barrel)/2)+" "+str_((square_barrel)/2)+" "+str_(-(square_barrel)/2)+" "+str_((square_barrel)/2)+" "+str2(-total_heigth/2)+" "+str2(total_heigth/2)+" \n")
    f.write("surf 22 cylz 0.0 0.0 "+str_((core_barrel_id)/2)+" "+str2(-total_heigth/2-0.004)+" "+ str2(total_heigth/2+0.004)+"\n")
    f.write("surf 23 cylz 0.0 0.0 "+str_((core_barrel_od)/2)+" "+str2(-total_heigth/2-0.004)+" "+ str2(total_heigth/2+0.004)+"\n")
    f.write("surf 24 cylz 0.0 0.0 "+str_((rpv_id)/2)+" "+str2(-total_heigth/2-0.004)+" "+ str2(total_heigth/2+0.004)+"\n")
    f.write("surf 25 cylz 0.0 0.0 "+str_((rpv_od)/2)+" "+str2(-total_heigth/2-0.004)+" "+ str2(total_heigth/2+0.004)+"\n")
    f.write("\n")
    f.write("/*** Pin definitions Seed Rod***/\n")
    f.write("pin puo_a01\n")
    f.write("uo_a01  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_a02\n")
    f.write("uo_a02  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_b01\n")
    f.write("uo_b01  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_c02g\n")
    f.write("uo_c02g      "+str_(radius_fuel)+"\n")
    f.write("helium      "+str_(radius_fuel+gap)+"\n")
    f.write("m5          "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_b02\n")
    f.write("uo_b02  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_c01\n")
    f.write("uo_c01  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_c02\n")
    f.write("uo_c02  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_c03\n")
    f.write("uo_c03  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin spplenum\n")
    f.write("inconel625      "+str_(spring)+"\n")
    f.write("helium  "+str_(radius_fuel+gap)+"\n")
    f.write("m5      "+str_(radius_fuel+gap+clad)+" \n")
    f.write("water\n")
    f.write("\n")
    f.write("pin spendcap\n")
    f.write("m5      "+str_(radius_fuel+gap+clad)+"\n") 
    f.write("water\n")
    f.write("\n")
    f.write("pin spcoolant\n")
    f.write("water   "+str_(radius_fuel+gap)+"\n")
    f.write("m5      "+str_(radius_fuel+gap+clad)+" \n")
    f.write("water\n")
    f.write("\n")
    f.write("pin spss304\n")
    f.write("ss304l   "+str_(radius_fuel+gap+clad)+"\n") 
    f.write("water\n")
    f.write("\n")
    f.write("pin G0\n")
    f.write("water     "+str_(radius_fuel)+"\n")
    f.write("water    "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("/*** Pin definitions Control Rod***/\n")
    f.write("\n")
    f.write("pin pempty\n")
    f.write("helium  "+str_(radius_aic)+"\n")
    f.write("ss304l  "+str_(radius_bar)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin pendplug\n")
    f.write("ss304l  "+str_(radius_bar)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin paic\n")
    f.write("AIC     "+str_(radius_aic)+"\n")
    f.write("helium  "+str_(radius_aic+gap)+"\n")
    f.write("ss304l  "+str_(radius_bar)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin pb4c\n")
    f.write("B4C    "+str_(radius_b4c)+"\n")
    f.write("helium "+str_(radius_b4c+gap)+"\n")
    f.write("ss304l "+str_(radius_bar)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin xx\n")
    f.write("ss304l\n")
    f.write("\n")
    f.write("pin ww\n")
    f.write("water\n")
    f.write("\n")
    f.write("/** Burn options Depletion zones **/\n")
    f.write("\n")
    f.write("div uo_a01 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+" \n")
    f.write("div uo_a02 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div uo_b01 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div uo_b02 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div uo_c01 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div uo_c02 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div uo_c03 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div uo_c02g subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div AIC subz "+str(parts)+" "+ str1((-total_heigth/2)+bottom_nozzle+empty_guide)+" "+ str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic)+" \n")
    f.write("div B4C subz "+str(parts)+" "+ str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic)+" "+ str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic+length_b4c)+"\n")
    f.write("\n")
    f.write("\n")
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n")
    f.write("cell A001 F1 ss304l             -2\n")
    f.write("cell A002 F1 fill spendcap       2  -3\n")
    f.write("cell A003 F1 fill puo_a01        3  -4\n")
    f.write("cell A004 F1 fill spplenum       4  -5\n")
    f.write("cell A005 F1 fill spendcap       5  -6\n")
    f.write("cell A006 F1 fill spcoolant      6  -7\n")
    f.write("cell A007 F1 ss304l              7\n")
    f.write("\n")
    f.write("/*** Verical layers (cells) for blanket rod***/\n")
    f.write("\n")
    f.write("cell A015 BC ss304l            -13\n")
    f.write("cell A016 BC fill pendplug      13  -14\n")
    f.write("cell A017 BC fill paic          14  -15\n")
    f.write("cell A018 BC fill pb4c          15  -16\n")
    f.write("cell A019 BC fill pendplug      16  -17\n")
    f.write("cell A020 BC fill pempty        17  -18\n")
    f.write("cell A021 BC ss304l             18\n")
    f.write("\n")
    f.write("/*** Lattice ***/\n")
    f.write("lat 101  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 G0 F1 F1 F1 F1 F1 F1 F1 F1 F1 G0 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 G0 F1 F1 F1 F1 F1 F1 F1 F1 F1 G0 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("\n") 
    f.write("cell A900 A01 fill 101 -9\n")   
    f.write("cell A901 A01 water  9\n")   
    f.write("\n") 
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n") 
    f.write("cell A022 F2 ss304l             -2\n")
    f.write("cell A023 F2 fill spendcap       2  -3\n")
    f.write("cell A024 F2 fill puo_a02        3  -4\n")
    f.write("cell A025 F2 fill spplenum       4  -5\n")
    f.write("cell A026 F2 fill spendcap       5  -6\n")
    f.write("cell A027 F2 fill spcoolant      6  -7\n")
    f.write("cell A028 F2 ss304l              7\n")
    f.write("\n") 
    f.write("/*** Lattice ***/\n")
    f.write("lat 201  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 G0 F2 F2 F2 F2 F2 F2 F2 F2 F2 G0 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 G0 F2 F2 F2 F2 F2 F2 F2 F2 F2 G0 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("\n") 
    f.write("cell A800 A02 fill 201 -9 \n")  
    f.write("cell A801 A02 water  9   \n")
    f.write("\n")
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n")
    f.write("cell A036 F3 ss304l             -2\n")
    f.write("cell A037 F3 fill spendcap       2  -3\n")
    f.write("cell A038 F3 fill puo_b01        3  -4\n")
    f.write("cell A039 F3 fill spplenum       4  -5\n")
    f.write("cell A040 F3 fill spendcap       5  -6\n")
    f.write("cell A041 F3 fill spcoolant      6  -7\n")
    f.write("cell A042 F3 ss304l              7\n")
    f.write("\n")
    f.write("/*** Lattice ***/\n")
    f.write("lat 301  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 G0 F3 F3 F3 F3 F3 F3 F3 F3 F3 G0 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 G0 F3 F3 F3 F3 F3 F3 F3 F3 F3 G0 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("\n") 
    f.write("cell A700 B01 fill  301 -9\n")   
    f.write("cell A701 B01 water  9\n")   
    f.write("\n")
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n")
    f.write("cell A044 F4 ss304l             -2\n")
    f.write("cell A045 F4 fill spendcap       2  -3\n")
    f.write("cell A046 F4 fill puo_b02        3  -4\n")
    f.write("cell A047 F4 fill spplenum       4  -5\n")
    f.write("cell A048 F4 fill spendcap       5  -6\n")
    f.write("cell A049 F4 fill spcoolant      6  -7\n")
    f.write("cell A050 F4 ss304l              7\n")
    f.write("\n")
    f.write("/*** Lattice ***/\n")
    f.write("lat 401  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 G0 F4 F4 F4 F4 F4 F4 F4 F4 F4 G0 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 G0 F4 F4 F4 F4 F4 F4 F4 F4 F4 G0 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("\n") 
    f.write("cell A600 B02 fill 401 -9 \n")  
    f.write("cell A601 B02 water  9 \n")  
    f.write("\n")
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n")
    f.write("cell A054 F5 ss304l             -2\n")
    f.write("cell A055 F5 fill spendcap       2  -3\n")
    f.write("cell A056 F5 fill puo_c01        3  -4\n")
    f.write("cell A057 F5 fill spplenum       4  -5\n")
    f.write("cell A058 F5 fill spendcap       5  -6\n")
    f.write("cell A059 F5 fill spcoolant      6  -7\n")
    f.write("cell A060 F5 ss304l              7\n")
    f.write("\n")
    f.write("/*** Lattice ***/\n")
    f.write("lat 501  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 G0 F5 F5 F5 F5 F5 F5 F5 F5 F5 G0 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 G0 F5 F5 F5 F5 F5 F5 F5 F5 F5 G0 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("\n") 
    f.write("cell A500 C01 fill 501 -9\n")   
    f.write("cell A501 C01 water 9\n")   
    f.write("\n")
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n")
    f.write("cell A074 F6 ss304l             -2\n")
    f.write("cell A075 F6 fill spendcap       2  -3\n")
    f.write("cell A076 F6 fill puo_c02        3  -4\n")
    f.write("cell A077 F6 fill spplenum       4  -5\n")
    f.write("cell A078 F6 fill spendcap       5  -6\n")
    f.write("cell A079 F6 fill spcoolant      6  -7\n")
    f.write("cell A080 F6 ss304l              7\n")
    f.write("\n")
    f.write("/*** Verical layers (cells) for fuel rod***/\n")
    f.write("\n")
    f.write("cell A081 F7 ss304l            -2\n")
    f.write("cell A082 F7 fill spendcap       2  -3\n")
    f.write("cell A083 F7 fill puo_c02g        3  -4\n")
    f.write("cell A084 F7 fill spplenum       4  -5\n")
    f.write("cell A085 F7 fill spendcap       5  -6\n")
    f.write("cell A086 F7 fill spcoolant      6  -7\n")
    f.write("cell A087 F7 ss304l             7\n")
    f.write("\n")
    f.write("/*** Lattice ***/\n")
    f.write("lat 601  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 F7 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 F7 F6 F6\n")
    f.write("F6 F6 F6 G0 F6 F6 F6 F7 F6 F7 F6 F6 F6 G0 F6 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F7 F6 F6 F6 F7 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 F6 F7 F6 F6 F6 F6 F6 F6 F6 F6 F6 F7 F6 F6 F6\n")
    f.write("F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6\n")
    f.write("F6 F6 F6 F7 F6 F6 F6 F6 F6 F6 F6 F6 F6 F7 F6 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F7 F6 F6 F6 F7 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 F6 G0 F6 F6 F6 F7 F6 F7 F6 F6 F6 G0 F6 F6 F6\n")
    f.write("F6 F6 F7 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 F7 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6\n")
    f.write("\n")
    f.write("cell A400 C02 fill 601 -9\n")   
    f.write("cell A401 C02 water  9\n")   
    f.write("\n") 
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n") 
    f.write("cell A092 F8 ss304l             -2\n")
    f.write("cell A093 F8 fill spendcap       2  -3\n")
    f.write("cell A094 F8 fill puo_c03        3  -4\n")
    f.write("cell A095 F8 fill spplenum       4  -5\n")
    f.write("cell A096 F8 fill spendcap       5  -6\n")
    f.write("cell A097 F8 fill spcoolant      6  -7\n")
    f.write("cell A098 F8 ss304l              7\n")
    f.write("\n") 
    f.write("/*** Lattice ***/\n")
    f.write("lat 701  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 G0 F8 F8 F8 F8 F8 F8 F8 F8 F8 G0 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 G0 F8 F8 F8 F8 F8 F8 F8 F8 F8 G0 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("\n") 
    f.write("cell A300 C03 fill 701 -9\n")   
    f.write("cell A301 C03 water  9\n")   
    f.write("\n")  
    f.write("/************************\n")
    f.write(" * Core Configuration\n")
    f.write(" ************************/\n")
    f.write("lat core1 1 0.0 0.0 "+str(number_assembly)+" "+str(number_assembly)+"  "+str_(length)+"\n")
    f.write(" HHH HHH C01 B02 C01 HHH HHH \n")
    f.write(" HHH C02 B01 A01 B01 C02 HHH \n")
    f.write(" C01 B01 A02 A01 A02 B01 C01 \n")
    f.write(" B02 A01 A01 C03 A01 A01 B02 \n")
    f.write(" C01 B01 A02 A01 A02 B01 C01 \n")
    f.write(" HHH C02 B01 A01 B01 C02 HHH \n")
    f.write(" HHH HHH C01 B02 C01 HHH HHH \n")
    f.write("\n")
    f.write("cell EC018 CORE fill core1  -21\n")
    f.write("cell EC019 CORE ss304l      21\n")
    f.write("\n")
    f.write("cell 8 0 fill CORE    -22\n")
    f.write("cell 9 0 ss304         22 -23\n")
    f.write("cell 10 0 water        23 -24\n")
    f.write("cell 11 0 ss508        24 -25\n")
    f.write("cell 12 0 outside        25  \n")
    f.write("cell E015 HHH ss304l  -11\n")
    f.write("\n")
    f.write("\n")
    f.write("/**Plot Graphs*/\n")
    f.write("plot 3 5000 5000 \n")
    f.write("plot 2 1500 3000\n")
    f.write("set print 1\n")
    f.write("set opti 1\n")
    f.write("\n") 
    f.write("/***Run Parameters***/\n")
    f.write("\n") 
    f.write(f"set pop {pop} {cyc} {incyc}\n")
    f.write(f"set bc {bc}\n")
    f.write(f"set power {power}\n")
    f.write(f"set title \"nuscale-{ind}\"\n")
    f.write("\n") 
    f.write("/*** Detector that calculates the pin power distribution in the assembly***/\n")
    f.write(f"ene	1	3	10000	1.00E-09	255\n")
    f.write("\n")
    f.write("/****Cross Section Library***/\n")
    f.write(f"set acelib \"{filepath1}\"\n") 
    f.write(f"set declib \"{filepath2}\"\n")
    f.write(f"set nfylib \"{filepath3}\"\n")
    f.write("\n") 
    f.write("/*** Moviment bar control***/\n")
    f.write("trans u G0 0 0 0\n")
    f.write("trans u BC 0 0 10\n")
    f.write("/*** Reproductibility***/\n")
    f.write("set repro 2\n")
    f.write("\n")
    f.write("/*** Lost Particles***/\n")
    f.write("set lost -1\n")
    f.write("\n")
    f.write("/*** Depletion history***/\n")
    f.write("dep daytot                                                         \n")
    for step in days:
        f.write(f"{step}\n")
    f.write("\n")
    f.write("\n")
    f.write("/*** Set inventary ***/\n")
    f.write("set inventory\n")
    f.write("430990\n")
    f.write("501260\n")
    f.write("340790\n")
    f.write("400930\n")
    f.write("551350\n")
    f.write("461070\n")
    f.write("531290\n")
    f.write("932370\n")
    f.write("952410\n")
    f.write("962440\n")
    f.write("631550\n")
    f.write("360850\n")
    f.write("380900\n")
    f.write("551370\n")
    f.write("621510\n")
    f.write("501200\n")
    f.write("501220\n")
    f.write("902320\n")
    f.write("902330\n")
    f.write("902340\n")
    f.write("912310\n")
    f.write("912320\n")
    f.write("912330\n")
    f.write("912340\n")
    f.write("922320\n")
    f.write("922330\n")
    f.write("922340\n")
    f.write("922350\n")
    f.write("922360\n")
    f.write("922380\n")
    f.write("932370\n")
    f.write("942380\n")
    f.write("942390\n")
    f.write("942400\n")
    f.write("942410\n")
    f.write("942420\n")
    f.write("952410\n")
    f.write("952420\n")
    f.write("952430\n")
    f.write("420990\n")
    f.write("430990\n")
    f.write("441010\n")
    f.write("451030\n")
    f.write("471090\n")
    f.write("551330\n")
    f.write("621470\n")
    f.write("621490\n")
    f.write("621500\n")
    f.write("621510\n")
    f.write("621520\n")
    f.write("601430\n")
    f.write("601450\n")
    f.write("631530\n")
    f.write("641550\n")
    f.write("541260\n")
    f.write("561330\n")
    f.write("541280\n")
    f.write("541290\n")
    f.write("541300\n")
    f.write("541310\n")
    f.write("541320\n")
    f.write("541330\n")
    f.write("541360\n")
    f.write("541340\n")
    f.write("541350\n")
    f.write("481060\n")
    f.write("481080\n")
    f.write("481100\n")
    f.write("481110\n")
    f.write("481120\n")
    f.write("481130\n")
    f.write("481140\n")
    f.write("481160\n")
    f.write("50110\n")
    f.write("50100\n")
    f.write("set printm 1 0\n")
    f.write("\n")
    f.write("/*** Calculating material volumes***/\n")
    f.write("set mcvol 100000000 \n")
###################################################################
####################### Detector definition and XSPlot#############
with open("nuscale_"+str(ind)+"d.c", "w") as f:
    f.write("/*** NuScale Reactor ***/\n") 
    f.write("%individuo:"+str(ind)+"\n")
    f.write("%\n")
    f.write("%vol fuel[cm^3]:"+str1(vol_fuel)+"\n")
    f.write("%vol mod.fuel[cm^3]:"+str1(vol_fuel_mod)+"\n")
    f.write("%ratio vm_vf fuel[-]:"+str1(ratio_vm_vf_fuel)+"\n")
    f.write("\n")
    f.write("/****Volumes materials***/\n")
    f.write("include/nuscale_"+str(ind)+"o.c.mvol \n")
    f.write("\n")
    f.write("/****Materials***/\n")
    f.write("include/mat_B4C.inc\n")
    f.write("include/mat_AIC.inc\n")
    f.write("include/mat_inconel625.inc\n")
    f.write("include/mat_ss304.inc\n")
    f.write("include/mat_ss304l.inc\n")
    f.write("include/mat_zircaloy4.inc\n")
    f.write(f"include/mat_water_{temp_mod}K.inc\n")
    f.write("include/mat_helium.inc\n")
    f.write("include/mat_m5.inc\n")
    f.write("include/mat_air.inc\n")
    f.write("include/mat_ss508.inc\n")
    f.write("\n")
    f.write("/****Materials fuels***/\n")
    f.write(f"include/uo_a01_{temp_fuel}K.inc\n")
    f.write(f"include/uo_a02_{temp_fuel}K.inc\n")
    f.write(f"include/uo_b01_{temp_fuel}K.inc\n")
    f.write(f"include/uo_b02_{temp_fuel}K.inc\n")
    f.write(f"include/uo_c01_{temp_fuel}K.inc\n")
    f.write(f"include/uo_c02_{temp_fuel}K.inc\n")
    f.write(f"include/uo_c02g_{temp_fuel}K.inc\n")
    f.write(f"include/uo_c03_{temp_fuel}K.inc\n")
    f.write("\n")
    f.write("/*** Axial surfaces for fuel rods ***/\n")
    f.write("/*** Surface bottom nozzle lower***/\n")
    f.write("surf 1 pz "+str1(-total_heigth/2)+" \n")
    f.write("\n")
    f.write("/*** Surface bottom nozzle top***/\n")
    f.write("surf 2 pz "+str1(-total_heigth/2 + bottom_nozzle)+"\n")
    f.write("\n")
    f.write("/*** Surface end cap top***/\n")
    f.write("surf 3 pz "+str1(-total_heigth/2 + (bottom_nozzle+end_cap))+"\n")
    f.write("\n")
    f.write("/*** Surface UOX***/\n")
    f.write("surf 4 pz "+str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+" \n")
    f.write("\n")
    f.write("/*** Surface plenum spring***/\n")
    f.write("surf 5 pz "+str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active+plenum_spring))+"\n")
    f.write("\n")
    f.write("/*** Surface end cap***/\n")
    f.write("surf 6 pz "+str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active+plenum_spring+end_cap))+" \n")
    f.write("\n")
    f.write("/*** Surface coolant***/\n")
    f.write("surf 7 pz "+str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active+plenum_spring+coolant))+" \n")
    f.write("\n")
    f.write("/*** Surface top nozzle***/\n")
    f.write("surf 8 pz "+str1(total_heigth/2)+"\n")
    f.write("\n")
    f.write("/*** Surface outside Lattice***/\n")
    f.write("surf 9 cuboid "+str_(-(length)/2)+" "+str_((length)/2)+" "+str_(-(length)/2)+" "+str_((length)/2)+" "+str1(-total_heigth/2)+" "+str1(total_heigth/2)+"\n")
    f.write("surf 10 cuboid "+str_(-length/2)+" "+str_(length/2)+" "+str_(-length/2)+" "+str_((length)/2)+" "+str1((-total_heigth)/2-0.05)+" "+str1((total_heigth)/2+0.05)+"\n")
    f.write("\n")
    f.write("/*** Surface outside Lattice***/\n")
    f.write("surf 11 inf\n")
    f.write("\n")
    f.write("/*** Axial surfaces for bar control ***/\n")
    f.write("/*** Surface bottom nozzle lower***/\n")
    f.write("surf 12 pz "+str1(-total_heigth/2)+"\n")
    f.write("\n")
    f.write("/*** Surface bottom nozzle top***/\n")
    f.write("surf 13 pz "+str1(-total_heigth/2 + bottom_nozzle)+"\n")
    f.write("\n")
    f.write("/*** Surface end cap top***/\n")
    f.write("surf 14 pz "+str1(-total_heigth/2 + (bottom_nozzle+end_cap))+"\n")
    f.write("\n")
    f.write("/*** Surface AIC***/\n")
    f.write("surf 15 pz "+str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic)+"\n")
    f.write("\n")
    f.write("/*** Surface plenum spring***/\n")
    f.write("surf 16 pz "+str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic+plenum_spring)+"\n")
    f.write("\n")
    f.write("/*** Surface B4C***/\n")
    f.write("surf 17 pz "+str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic+plenum_spring+length_b4c)+"\n")
    f.write("\n")
    f.write("/*** Surface plenum spring***/\n")
    f.write("surf 18 pz "+str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic+length_b4c+upper_plenum)+"\n")
    f.write("\n")
    f.write("/*** Surface top nozzle***/\n")
    f.write("surf 19 pz "+str1(total_heigth/2)+"\n")
    f.write("\n")
    f.write("/*** Surfaces outside core***/\n")
    f.write("surf 20 cuboid "+str_(-(square_barrel)/2)+" "+str_((square_barrel)/2)+" "+str_(-(square_barrel)/2)+" "+str_((square_barrel)/2)+" "+str1(-total_heigth/2)+" "+str1(total_heigth/2)+" \n")
    f.write("surf 21 cuboid "+str_(-(square_barrel)/2)+" "+str_((square_barrel)/2)+" "+str_(-(square_barrel)/2)+" "+str_((square_barrel)/2)+" "+str2(-total_heigth/2)+" "+str2(total_heigth/2)+" \n")
    f.write("surf 22 cylz 0.0 0.0 "+str_((core_barrel_id)/2)+" "+str2(-total_heigth/2-0.004)+" "+ str2(total_heigth/2+0.004)+"\n")
    f.write("surf 23 cylz 0.0 0.0 "+str_((core_barrel_od)/2)+" "+str2(-total_heigth/2-0.004)+" "+ str2(total_heigth/2+0.004)+"\n")
    f.write("surf 24 cylz 0.0 0.0 "+str_((rpv_id)/2)+" "+str2(-total_heigth/2-0.004)+" "+ str2(total_heigth/2+0.004)+"\n")
    f.write("surf 25 cylz 0.0 0.0 "+str_((rpv_od)/2)+" "+str2(-total_heigth/2-0.004)+" "+ str2(total_heigth/2+0.004)+"\n")
    f.write("\n")
    f.write("/*** Pin definitions Seed Rod***/\n")
    f.write("pin puo_a01\n")
    f.write("uo_a01  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_a02\n")
    f.write("uo_a02  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_b01\n")
    f.write("uo_b01  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_b02\n")
    f.write("uo_b02  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_c01\n")
    f.write("uo_c01  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_c02\n")
    f.write("uo_c02  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_c02g\n")
    f.write("uo_c02g  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_c03\n")
    f.write("uo_c03  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin spplenum\n")
    f.write("inconel625      "+str_(spring)+"\n")
    f.write("helium  "+str_(radius_fuel+gap)+"\n")
    f.write("m5      "+str_(radius_fuel+gap+clad)+" \n")
    f.write("water\n")
    f.write("\n")
    f.write("pin spendcap\n")
    f.write("m5      "+str_(radius_fuel+gap+clad)+"\n") 
    f.write("water\n")
    f.write("\n")
    f.write("pin spcoolant\n")
    f.write("water   "+str_(radius_fuel+gap)+"\n")
    f.write("m5      "+str_(radius_fuel+gap+clad)+" \n")
    f.write("water\n")
    f.write("\n")
    f.write("pin spss304\n")
    f.write("ss304l   "+str_(radius_fuel+gap+clad)+"\n") 
    f.write("water\n")
    f.write("\n")
    f.write("pin G0\n")
    f.write("water     "+str_(radius_fuel)+"\n")
    f.write("water    "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("/*** Pin definitions Control Rod***/\n")
    f.write("\n")
    f.write("pin pempty\n")
    f.write("helium  "+str_(radius_aic)+"\n")
    f.write("ss304l  "+str_(radius_bar)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin pendplug\n")
    f.write("ss304l  "+str_(radius_bar)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin paic\n")
    f.write("AIC     "+str_(radius_aic)+"\n")
    f.write("helium  "+str_(radius_aic+gap)+"\n")
    f.write("ss304l  "+str_(radius_bar)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin pb4c\n")
    f.write("B4C    "+str_(radius_b4c)+"\n")
    f.write("helium "+str_(radius_b4c+gap)+"\n")
    f.write("ss304l "+str_(radius_bar)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin xx\n")
    f.write("ss304l\n")
    f.write("\n")
    f.write("pin ww\n")
    f.write("water\n")
    f.write("\n")
    f.write("/** Burn options Depletion zones **/\n")
    f.write("\n")
    f.write("div uo_a01 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+" \n")
    f.write("div uo_a02 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div uo_b01 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div uo_b02 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div uo_c01 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div uo_c02 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div uo_c03 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div uo_c02g subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div AIC subz "+str(parts)+" "+ str1((-total_heigth/2)+bottom_nozzle+empty_guide)+" "+ str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic)+" \n")
    f.write("div B4C subz "+str(parts)+" "+ str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic)+" "+ str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic+length_b4c)+"\n")
    f.write("\n")
    f.write("\n")
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n")
    f.write("cell A001 F1 ss304l             -2\n")
    f.write("cell A002 F1 fill spendcap       2  -3\n")
    f.write("cell A003 F1 fill puo_a01        3  -4\n")
    f.write("cell A004 F1 fill spplenum       4  -5\n")
    f.write("cell A005 F1 fill spendcap       5  -6\n")
    f.write("cell A006 F1 fill spcoolant      6  -7\n")
    f.write("cell A007 F1 ss304l              7\n")
    f.write("\n")
    f.write("/*** Verical layers (cells) for blanket rod***/\n")
    f.write("\n")
    f.write("cell A015 BC ss304l            -13\n")
    f.write("cell A016 BC fill pendplug      13  -14\n")
    f.write("cell A017 BC fill paic          14  -15\n")
    f.write("cell A018 BC fill pb4c          15  -16\n")
    f.write("cell A019 BC fill pendplug      16  -17\n")
    f.write("cell A020 BC fill pempty        17  -18\n")
    f.write("cell A021 BC ss304l             18\n")
    f.write("\n")
    f.write("/*** Lattice ***/\n")
    f.write("lat 101  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 G0 F1 F1 F1 F1 F1 F1 F1 F1 F1 G0 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 G0 F1 F1 F1 F1 F1 F1 F1 F1 F1 G0 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("\n") 
    f.write("cell A900 A01 fill 101 -9\n")   
    f.write("cell A901 A01 water  9\n")   
    f.write("\n") 
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n") 
    f.write("cell A022 F2 ss304l             -2\n")
    f.write("cell A023 F2 fill spendcap       2  -3\n")
    f.write("cell A024 F2 fill puo_a02        3  -4\n")
    f.write("cell A025 F2 fill spplenum       4  -5\n")
    f.write("cell A026 F2 fill spendcap       5  -6\n")
    f.write("cell A027 F2 fill spcoolant      6  -7\n")
    f.write("cell A028 F2 ss304l              7\n")
    f.write("\n") 
    f.write("/*** Lattice ***/\n")
    f.write("lat 201  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 G0 F2 F2 F2 F2 F2 F2 F2 F2 F2 G0 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 G0 F2 F2 F2 F2 F2 F2 F2 F2 F2 G0 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("\n") 
    f.write("cell A800 A02 fill 201 -9 \n")  
    f.write("cell A801 A02 water  9   \n")
    f.write("\n")
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n")
    f.write("cell A036 F3 ss304l             -2\n")
    f.write("cell A037 F3 fill spendcap       2  -3\n")
    f.write("cell A038 F3 fill puo_b01        3  -4\n")
    f.write("cell A039 F3 fill spplenum       4  -5\n")
    f.write("cell A040 F3 fill spendcap       5  -6\n")
    f.write("cell A041 F3 fill spcoolant      6  -7\n")
    f.write("cell A042 F3 ss304l              7\n")
    f.write("\n")
    f.write("/*** Lattice ***/\n")
    f.write("lat 301  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 G0 F3 F3 F3 F3 F3 F3 F3 F3 F3 G0 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 G0 F3 F3 F3 F3 F3 F3 F3 F3 F3 G0 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("\n") 
    f.write("cell A700 B01 fill  301 -9\n")   
    f.write("cell A701 B01 water  9\n")   
    f.write("\n")
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n")
    f.write("cell A044 F4 ss304l             -2\n")
    f.write("cell A045 F4 fill spendcap       2  -3\n")
    f.write("cell A046 F4 fill puo_b02        3  -4\n")
    f.write("cell A047 F4 fill spplenum       4  -5\n")
    f.write("cell A048 F4 fill spendcap       5  -6\n")
    f.write("cell A049 F4 fill spcoolant      6  -7\n")
    f.write("cell A050 F4 ss304l              7\n")
    f.write("\n")
    f.write("/*** Lattice ***/\n")
    f.write("lat 401  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 G0 F4 F4 F4 F4 F4 F4 F4 F4 F4 G0 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 G0 F4 F4 F4 F4 F4 F4 F4 F4 F4 G0 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("\n") 
    f.write("cell A600 B02 fill 401 -9 \n")  
    f.write("cell A601 B02 water  9 \n")  
    f.write("\n")
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n")
    f.write("cell A054 F5 ss304l             -2\n")
    f.write("cell A055 F5 fill spendcap       2  -3\n")
    f.write("cell A056 F5 fill puo_c01        3  -4\n")
    f.write("cell A057 F5 fill spplenum       4  -5\n")
    f.write("cell A058 F5 fill spendcap       5  -6\n")
    f.write("cell A059 F5 fill spcoolant      6  -7\n")
    f.write("cell A060 F5 ss304l              7\n")
    f.write("\n")
    f.write("/*** Lattice ***/\n")
    f.write("lat 501  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 G0 F5 F5 F5 F5 F5 F5 F5 F5 F5 G0 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 G0 F5 F5 F5 F5 F5 F5 F5 F5 F5 G0 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("\n") 
    f.write("cell A500 C01 fill 501 -9\n")   
    f.write("cell A501 C01 water 9\n")   
    f.write("\n")
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n")
    f.write("cell A074 F6 ss304l             -2\n")
    f.write("cell A075 F6 fill spendcap       2  -3\n")
    f.write("cell A076 F6 fill puo_c02        3  -4\n")
    f.write("cell A077 F6 fill spplenum       4  -5\n")
    f.write("cell A078 F6 fill spendcap       5  -6\n")
    f.write("cell A079 F6 fill spcoolant      6  -7\n")
    f.write("cell A080 F6 ss304l              7\n")
    f.write("\n")
    f.write("/*** Verical layers (cells) for fuel rod***/\n")
    f.write("\n")
    f.write("cell A081 F7 ss304l            -2\n")
    f.write("cell A082 F7 fill spendcap       2  -3\n")
    f.write("cell A083 F7 fill puo_c02g        3  -4\n")
    f.write("cell A084 F7 fill spplenum       4  -5\n")
    f.write("cell A085 F7 fill spendcap       5  -6\n")
    f.write("cell A086 F7 fill spcoolant      6  -7\n")
    f.write("cell A087 F7 ss304l             7\n")
    f.write("\n")
    f.write("/*** Lattice ***/\n")
    f.write("lat 601  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 F7 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 F7 F6 F6\n")
    f.write("F6 F6 F6 G0 F6 F6 F6 F7 F6 F7 F6 F6 F6 G0 F6 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F7 F6 F6 F6 F7 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 F6 F7 F6 F6 F6 F6 F6 F6 F6 F6 F6 F7 F6 F6 F6\n")
    f.write("F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6\n")
    f.write("F6 F6 F6 F7 F6 F6 F6 F6 F6 F6 F6 F6 F6 F7 F6 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F7 F6 F6 F6 F7 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 F6 G0 F6 F6 F6 F7 F6 F7 F6 F6 F6 G0 F6 F6 F6\n")
    f.write("F6 F6 F7 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 F7 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6\n")
    f.write("\n")
    f.write("cell A400 C02 fill 601 -9\n")   
    f.write("cell A401 C02 water  9\n")   
    f.write("\n") 
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n") 
    f.write("cell A092 F8 ss304l             -2\n")
    f.write("cell A093 F8 fill spendcap       2  -3\n")
    f.write("cell A094 F8 fill puo_c03        3  -4\n")
    f.write("cell A095 F8 fill spplenum       4  -5\n")
    f.write("cell A096 F8 fill spendcap       5  -6\n")
    f.write("cell A097 F8 fill spcoolant      6  -7\n")
    f.write("cell A098 F8 ss304l              7\n")
    f.write("\n") 
    f.write("/*** Lattice ***/\n")
    f.write("lat 701  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 G0 F8 F8 F8 F8 F8 F8 F8 F8 F8 G0 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 G0 F8 F8 F8 F8 F8 F8 F8 F8 F8 G0 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("\n") 
    f.write("cell A300 C03 fill 701 -9\n")   
    f.write("cell A301 C03 water  9\n")   
    f.write("\n")  
    f.write("/************************\n")
    f.write(" * Core Configuration\n")
    f.write(" ************************/\n")
    f.write("lat core1 1 0.0 0.0 "+str(number_assembly)+" "+str(number_assembly)+"  "+str_(length)+"\n")
    f.write(" HHH HHH C01 B02 C01 HHH HHH \n")
    f.write(" HHH C02 B01 A01 B01 C02 HHH \n")
    f.write(" C01 B01 A02 A01 A02 B01 C01 \n")
    f.write(" B02 A01 A01 C03 A01 A01 B02 \n")
    f.write(" C01 B01 A02 A01 A02 B01 C01 \n")
    f.write(" HHH C02 B01 A01 B01 C02 HHH \n")
    f.write(" HHH HHH C01 B02 C01 HHH HHH \n")
    f.write("\n")
    f.write("cell EC018 CORE fill core1  -21\n")
    f.write("cell EC019 CORE ss304l      21\n")
    f.write("\n")
    f.write("cell 8 0 fill CORE    -22\n")
    f.write("cell 9 0 ss304         22 -23\n")
    f.write("cell 10 0 water        23 -24\n")
    f.write("cell 11 0 ss508        24 -25\n")
    f.write("cell 12 0 outside        25  \n")
    f.write("cell E015 HHH ss304l  -11\n")
    f.write("\n")
    f.write("\n")
    f.write("/**Plot Graphs*/\n")
    f.write("plot 3 5000 5000\n")
    f.write("mesh 3 5000 5000\n")
    f.write("plot 2 1500 3000\n")
    f.write("set print 1\n")
    f.write("set opti 1\n")
    f.write("\n") 
    f.write("/***Run Parameters***/\n")
    f.write("\n") 
    f.write(f"set pop {pop} {cyc} {incyc}\n")
    f.write(f"set bc {bc}\n")
    f.write(f"set power {power}\n")
    f.write(f"set title \"nuscale-{ind+1}\"\n")
    f.write("\n") 
    f.write("/*** Detector that calculates the pin power distribution in the assembly***/\n")
    f.write(f"ene	1	3	10000	1.00E-09	255\n")
    f.write("\n")
    f.write("/***Calculation detector***/\n")
    f.write("det 1\n")
    f.write(f"dr -6 void\n")
    f.write(f"dx {str1(-core_barrel_id/2 )} {str1(core_barrel_id/2 )} 80\n")
    f.write(f"dy {str1(-core_barrel_id/2 )} {str1(core_barrel_id/2 )} 80\n")
    f.write(f"dz {str1(-total_heigth / 2)} {str1(total_heigth / 2)} 100\n")
    f.write("\n")
    f.write("/****Cross Section Library***/\n")
    f.write(f"set acelib \"{filepath1}\"\n") 
    f.write(f"set declib \"{filepath2}\"\n")
    f.write(f"set nfylib \"{filepath3}\"\n")
    f.write("\n") 
    f.write("/*** Moviment bar control***/\n")
    f.write("trans u G0 0 0 0\n")
    f.write("trans u BC 0 0 10\n")
    f.write("/*** Reproductibility***/\n")
    f.write("set repro 2\n")
    f.write("\n")
    f.write("/*** Lost Particles***/\n")
    f.write("set lost -1\n")
    f.write("\n")
    f.write("/*** Depletion history***/\n")
    f.write("set printm 1 0\n")
    f.write("set opti 1 \n")
    f.write("\n")
    f.write("/*** Cross section Data***/\n")
    f.write(f"set xsplot 10000 1.00E-09 10000 \n")
    f.write("\n")
    f.write("/*** Calculating material volumes***/\n")
    f.write("set mcvol 100000000 \n")
####################################################################
################### Calculate Volumes ##############################    
with open("nuscale_"+str(ind)+"o.c", "w") as f:
    f.write("/*** NuScale Reactor ***/\n") 
    f.write("%individuo:"+str(ind)+"\n")
    f.write("%parts:"+str(parts)+"\n")
    f.write("%vol fuel[cm^3]:"+str1(vol_fuel)+"\n")
    f.write("%vol mod.fuel[cm^3]:"+str1(vol_fuel_mod)+"\n")
    f.write("%ratio vm_vf fuel[-]:"+str1(ratio_vm_vf_fuel)+"\n")
    f.write("\n")
    f.write("/****Volumes materials***/\n")
    f.write("%include/nuscale_"+str(ind)+".c.mvol \n")
    f.write("\n")
    f.write("/****Materials***/\n")
    f.write("include/mat_B4C.inc\n")
    f.write("include/mat_AIC.inc\n")
    f.write("include/mat_inconel625.inc\n")
    f.write("include/mat_ss304.inc\n")
    f.write("include/mat_ss304l.inc\n")
    f.write("include/mat_zircaloy4.inc\n")
    f.write(f"include/mat_water_{temp_mod}K.inc\n")
    f.write("include/mat_helium.inc\n")
    f.write("include/mat_m5.inc\n")
    f.write("include/mat_air.inc\n")
    f.write("include/mat_ss508.inc\n")
    f.write("\n")
    f.write("/****Materials fuels***/\n")
    f.write(f"include/uo_a01_{temp_fuel}K.inc\n")
    f.write(f"include/uo_a02_{temp_fuel}K.inc\n")
    f.write(f"include/uo_b01_{temp_fuel}K.inc\n")
    f.write(f"include/uo_b02_{temp_fuel}K.inc\n")
    f.write(f"include/uo_c01_{temp_fuel}K.inc\n")
    f.write(f"include/uo_c02_{temp_fuel}K.inc\n")
    f.write(f"include/uo_c02g_{temp_fuel}K.inc\n")
    f.write(f"include/uo_c03_{temp_fuel}K.inc\n")
    f.write("\n")
    f.write("/*** Axial surfaces for fuel rods ***/\n")
    f.write("/*** Surface bottom nozzle lower***/\n")
    f.write("surf 1 pz "+str1(-total_heigth/2)+" \n")
    f.write("\n")
    f.write("/*** Surface bottom nozzle top***/\n")
    f.write("surf 2 pz "+str1(-total_heigth/2 + bottom_nozzle)+"\n")
    f.write("\n")
    f.write("/*** Surface end cap top***/\n")
    f.write("surf 3 pz "+str1(-total_heigth/2 + (bottom_nozzle+end_cap))+"\n")
    f.write("\n")
    f.write("/*** Surface UOX***/\n")
    f.write("surf 4 pz "+str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+" \n")
    f.write("\n")
    f.write("/*** Surface plenum spring***/\n")
    f.write("surf 5 pz "+str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active+plenum_spring))+"\n")
    f.write("\n")
    f.write("/*** Surface end cap***/\n")
    f.write("surf 6 pz "+str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active+plenum_spring+end_cap))+" \n")
    f.write("\n")
    f.write("/*** Surface coolant***/\n")
    f.write("surf 7 pz "+str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active+plenum_spring+coolant))+" \n")
    f.write("\n")
    f.write("/*** Surface top nozzle***/\n")
    f.write("surf 8 pz "+str1(total_heigth/2)+"\n")
    f.write("\n")
    f.write("/*** Surface outside Lattice***/\n")
    f.write("surf 9 cuboid "+str_(-(length)/2)+" "+str_((length)/2)+" "+str_(-(length)/2)+" "+str_((length)/2)+" "+str1(-total_heigth/2)+" "+str1(total_heigth/2)+"\n")
    f.write("surf 10 cuboid "+str_(-length/2)+" "+str_(length/2)+" "+str_(-length/2)+" "+str_((length)/2)+" "+str1((-total_heigth)/2-0.05)+" "+str1((total_heigth)/2+0.05)+"\n")
    f.write("\n")
    f.write("/*** Surface outside Lattice***/\n")
    f.write("surf 11 inf\n")
    f.write("\n")
    f.write("/*** Axial surfaces for bar control ***/\n")
    f.write("/*** Surface bottom nozzle lower***/\n")
    f.write("surf 12 pz "+str1(-total_heigth/2)+"\n")
    f.write("\n")
    f.write("/*** Surface bottom nozzle top***/\n")
    f.write("surf 13 pz "+str1(-total_heigth/2 + bottom_nozzle)+"\n")
    f.write("\n")
    f.write("/*** Surface end cap top***/\n")
    f.write("surf 14 pz "+str1(-total_heigth/2 + (bottom_nozzle+end_cap))+"\n")
    f.write("\n")
    f.write("/*** Surface AIC***/\n")
    f.write("surf 15 pz "+str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic)+"\n")
    f.write("\n")
    f.write("/*** Surface plenum spring***/\n")
    f.write("surf 16 pz "+str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic+plenum_spring)+"\n")
    f.write("\n")
    f.write("/*** Surface B4C***/\n")
    f.write("surf 17 pz "+str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic+plenum_spring+length_b4c)+"\n")
    f.write("\n")
    f.write("/*** Surface plenum spring***/\n")
    f.write("surf 18 pz "+str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic+length_b4c+upper_plenum)+"\n")
    f.write("\n")
    f.write("/*** Surface top nozzle***/\n")
    f.write("surf 19 pz "+str1(total_heigth/2)+"\n")
    f.write("\n")
    f.write("/*** Surfaces outside core***/\n")
    f.write("surf 20 cuboid "+str_(-(square_barrel)/2)+" "+str_((square_barrel)/2)+" "+str_(-(square_barrel)/2)+" "+str_((square_barrel)/2)+" "+str1(-total_heigth/2)+" "+str1(total_heigth/2)+" \n")
    f.write("surf 21 cuboid "+str_(-(square_barrel)/2)+" "+str_((square_barrel)/2)+" "+str_(-(square_barrel)/2)+" "+str_((square_barrel)/2)+" "+str2(-total_heigth/2)+" "+str2(total_heigth/2)+" \n")
    f.write("surf 22 cylz 0.0 0.0 "+str_((core_barrel_id)/2)+" "+str2(-total_heigth/2-0.004)+" "+ str2(total_heigth/2+0.004)+"\n")
    f.write("surf 23 cylz 0.0 0.0 "+str_((core_barrel_od)/2)+" "+str2(-total_heigth/2-0.004)+" "+ str2(total_heigth/2+0.004)+"\n")
    f.write("surf 24 cylz 0.0 0.0 "+str_((rpv_id)/2)+" "+str2(-total_heigth/2-0.004)+" "+ str2(total_heigth/2+0.004)+"\n")
    f.write("surf 25 cylz 0.0 0.0 "+str_((rpv_od)/2)+" "+str2(-total_heigth/2-0.004)+" "+ str2(total_heigth/2+0.004)+"\n")
    f.write("\n")
    f.write("/*** Pin definitions Seed Rod***/\n")
    f.write("pin puo_a01\n")
    f.write("uo_a01  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_a02\n")
    f.write("uo_a02  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_b01\n")
    f.write("uo_b01  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_b02\n")
    f.write("uo_b02  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_c01\n")
    f.write("uo_c01  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_c02\n")
    f.write("uo_c02  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin puo_c03\n")
    f.write("uo_c03  "+str_(radius_fuel)+"\n") 
    f.write("helium   "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin spplenum\n")
    f.write("inconel625      "+str_(spring)+"\n")
    f.write("helium  "+str_(radius_fuel+gap)+"\n")
    f.write("m5      "+str_(radius_fuel+gap+clad)+" \n")
    f.write("water\n")
    f.write("\n")
    f.write("pin spendcap\n")
    f.write("m5      "+str_(radius_fuel+gap+clad)+"\n") 
    f.write("water\n")
    f.write("\n")
    f.write("pin spcoolant\n")
    f.write("water   "+str_(radius_fuel+gap)+"\n")
    f.write("m5      "+str_(radius_fuel+gap+clad)+" \n")
    f.write("water\n")
    f.write("\n")
    f.write("pin spss304\n")
    f.write("ss304l   "+str_(radius_fuel+gap+clad)+"\n") 
    f.write("water\n")
    f.write("\n")
    f.write("pin G0\n")
    f.write("water     "+str_(radius_fuel)+"\n")
    f.write("water    "+str_(radius_fuel+gap)+"\n")
    f.write("m5       "+str_(radius_fuel+gap+clad)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("/*** Pin definitions Control Rod***/\n")
    f.write("\n")
    f.write("pin pempty\n")
    f.write("helium  "+str_(radius_aic)+"\n")
    f.write("ss304l  "+str_(radius_bar)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin pendplug\n")
    f.write("ss304l  "+str_(radius_bar)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin paic\n")
    f.write("AIC     "+str_(radius_aic)+"\n")
    f.write("helium  "+str_(radius_aic+gap)+"\n")
    f.write("ss304l  "+str_(radius_bar)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin pb4c\n")
    f.write("B4C    "+str_(radius_b4c)+"\n")
    f.write("helium "+str_(radius_b4c+gap)+"\n")
    f.write("ss304l "+str_(radius_bar)+"\n")
    f.write("water\n")
    f.write("\n")
    f.write("pin xx\n")
    f.write("ss304l\n")
    f.write("\n")
    f.write("pin ww\n")
    f.write("water\n")
    f.write("\n")
    f.write("/** Burn options Depletion zones **/\n")
    f.write("\n")
    f.write("div uo_a01 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+" \n")
    f.write("div uo_a02 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div uo_b01 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div uo_b02 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div uo_c01 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div uo_c02 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div uo_c03 subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div uo_c02g subz "+str(parts)+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap))+" "+ str1(-total_heigth/2+(bottom_nozzle+end_cap+heigth_active))+"\n")
    f.write("div AIC subz "+str(parts)+" "+ str1((-total_heigth/2)+bottom_nozzle+empty_guide)+" "+ str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic)+" \n")
    f.write("div B4C subz "+str(parts)+" "+ str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic)+" "+ str1((-total_heigth/2)+bottom_nozzle+empty_guide+end_plug+length_aic+length_b4c)+"\n")
    f.write("\n")
    f.write("\n")
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n")
    f.write("cell A001 F1 ss304l             -2\n")
    f.write("cell A002 F1 fill spendcap       2  -3\n")
    f.write("cell A003 F1 fill puo_a01        3  -4\n")
    f.write("cell A004 F1 fill spplenum       4  -5\n")
    f.write("cell A005 F1 fill spendcap       5  -6\n")
    f.write("cell A006 F1 fill spcoolant      6  -7\n")
    f.write("cell A007 F1 ss304l              7\n")
    f.write("\n")
    f.write("/*** Verical layers (cells) for blanket rod***/\n")
    f.write("\n")
    f.write("cell A015 BC ss304l            -13\n")
    f.write("cell A016 BC fill pendplug      13  -14\n")
    f.write("cell A017 BC fill paic          14  -15\n")
    f.write("cell A018 BC fill pb4c          15  -16\n")
    f.write("cell A019 BC fill pendplug      16  -17\n")
    f.write("cell A020 BC fill pempty        17  -18\n")
    f.write("cell A021 BC ss304l             18\n")
    f.write("\n")
    f.write("/*** Lattice ***/\n")
    f.write("lat 101  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 G0 F1 F1 F1 F1 F1 F1 F1 F1 F1 G0 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 G0 F1 F1 F1 F1 F1 F1 F1 F1 F1 G0 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 G0 F1 F1 G0 F1 F1 G0 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1 F1\n")
    f.write("\n") 
    f.write("cell A900 A01 fill 101 -9\n")   
    f.write("cell A901 A01 water  9\n")   
    f.write("\n") 
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n") 
    f.write("cell A022 F2 ss304l             -2\n")
    f.write("cell A023 F2 fill spendcap       2  -3\n")
    f.write("cell A024 F2 fill puo_a02        3  -4\n")
    f.write("cell A025 F2 fill spplenum       4  -5\n")
    f.write("cell A026 F2 fill spendcap       5  -6\n")
    f.write("cell A027 F2 fill spcoolant      6  -7\n")
    f.write("cell A028 F2 ss304l              7\n")
    f.write("\n") 
    f.write("/*** Lattice ***/\n")
    f.write("lat 201  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 G0 F2 F2 F2 F2 F2 F2 F2 F2 F2 G0 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 G0 F2 F2 F2 F2 F2 F2 F2 F2 F2 G0 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 G0 F2 F2 G0 F2 F2 G0 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2 F2\n")
    f.write("\n") 
    f.write("cell A800 A02 fill 201 -9 \n")  
    f.write("cell A801 A02 water  9   \n")
    f.write("\n")
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n")
    f.write("cell A036 F3 ss304l             -2\n")
    f.write("cell A037 F3 fill spendcap       2  -3\n")
    f.write("cell A038 F3 fill puo_b01        3  -4\n")
    f.write("cell A039 F3 fill spplenum       4  -5\n")
    f.write("cell A040 F3 fill spendcap       5  -6\n")
    f.write("cell A041 F3 fill spcoolant      6  -7\n")
    f.write("cell A042 F3 ss304l              7\n")
    f.write("\n")
    f.write("/*** Lattice ***/\n")
    f.write("lat 301  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 G0 F3 F3 F3 F3 F3 F3 F3 F3 F3 G0 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 G0 F3 F3 F3 F3 F3 F3 F3 F3 F3 G0 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 G0 F3 F3 G0 F3 F3 G0 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3 F3\n")
    f.write("\n") 
    f.write("cell A700 B01 fill  301 -9\n")   
    f.write("cell A701 B01 water  9\n")   
    f.write("\n")
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n")
    f.write("cell A044 F4 ss304l             -2\n")
    f.write("cell A045 F4 fill spendcap       2  -3\n")
    f.write("cell A046 F4 fill puo_b02        3  -4\n")
    f.write("cell A047 F4 fill spplenum       4  -5\n")
    f.write("cell A048 F4 fill spendcap       5  -6\n")
    f.write("cell A049 F4 fill spcoolant      6  -7\n")
    f.write("cell A050 F4 ss304l              7\n")
    f.write("\n")
    f.write("/*** Lattice ***/\n")
    f.write("lat 401  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 G0 F4 F4 F4 F4 F4 F4 F4 F4 F4 G0 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 G0 F4 F4 F4 F4 F4 F4 F4 F4 F4 G0 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 G0 F4 F4 G0 F4 F4 G0 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4 F4\n")
    f.write("\n") 
    f.write("cell A600 B02 fill 401 -9 \n")  
    f.write("cell A601 B02 water  9 \n")  
    f.write("\n")
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n")
    f.write("cell A054 F5 ss304l             -2\n")
    f.write("cell A055 F5 fill spendcap       2  -3\n")
    f.write("cell A056 F5 fill puo_c01        3  -4\n")
    f.write("cell A057 F5 fill spplenum       4  -5\n")
    f.write("cell A058 F5 fill spendcap       5  -6\n")
    f.write("cell A059 F5 fill spcoolant      6  -7\n")
    f.write("cell A060 F5 ss304l              7\n")
    f.write("\n")
    f.write("/*** Lattice ***/\n")
    f.write("lat 501  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 G0 F5 F5 F5 F5 F5 F5 F5 F5 F5 G0 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 G0 F5 F5 F5 F5 F5 F5 F5 F5 F5 G0 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 G0 F5 F5 G0 F5 F5 G0 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5 F5\n")
    f.write("\n") 
    f.write("cell A500 C01 fill 501 -9\n")   
    f.write("cell A501 C01 water 9\n")   
    f.write("\n")
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n")
    f.write("cell A074 F6 ss304l             -2\n")
    f.write("cell A075 F6 fill spendcap       2  -3\n")
    f.write("cell A076 F6 fill puo_c02        3  -4\n")
    f.write("cell A077 F6 fill spplenum       4  -5\n")
    f.write("cell A078 F6 fill spendcap       5  -6\n")
    f.write("cell A079 F6 fill spcoolant      6  -7\n")
    f.write("cell A080 F6 ss304l              7\n")
    f.write("\n")
    f.write("/*** Verical layers (cells) for fuel rod***/\n")
    f.write("\n")
    f.write("cell A081 F7 ss304l            -2\n")
    f.write("cell A082 F7 fill spendcap       2  -3\n")
    f.write("cell A083 F7 fill puo_c02g        3  -4\n")
    f.write("cell A084 F7 fill spplenum       4  -5\n")
    f.write("cell A085 F7 fill spendcap       5  -6\n")
    f.write("cell A086 F7 fill spcoolant      6  -7\n")
    f.write("cell A087 F7 ss304l             7\n")
    f.write("\n")
    f.write("/*** Lattice ***/\n")
    f.write("lat 601  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 F7 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 F7 F6 F6\n")
    f.write("F6 F6 F6 G0 F6 F6 F6 F7 F6 F7 F6 F6 F6 G0 F6 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F7 F6 F6 F6 F7 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 F6 F7 F6 F6 F6 F6 F6 F6 F6 F6 F6 F7 F6 F6 F6\n")
    f.write("F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6\n")
    f.write("F6 F6 F6 F7 F6 F6 F6 F6 F6 F6 F6 F6 F6 F7 F6 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F7 F6 F6 F6 F7 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 F6 G0 F6 F6 F6 F7 F6 F7 F6 F6 F6 G0 F6 F6 F6\n")
    f.write("F6 F6 F7 F6 F6 G0 F6 F6 G0 F6 F6 G0 F6 F6 F7 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6\n")
    f.write("F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6 F6\n")
    f.write("\n")
    f.write("cell A400 C02 fill 601 -9\n")   
    f.write("cell A401 C02 water  9\n")   
    f.write("\n") 
    f.write("/*** Verical layers (cells) for seed rod***/\n")
    f.write("\n") 
    f.write("cell A092 F8 ss304l             -2\n")
    f.write("cell A093 F8 fill spendcap       2  -3\n")
    f.write("cell A094 F8 fill puo_c03        3  -4\n")
    f.write("cell A095 F8 fill spplenum       4  -5\n")
    f.write("cell A096 F8 fill spendcap       5  -6\n")
    f.write("cell A097 F8 fill spcoolant      6  -7\n")
    f.write("cell A098 F8 ss304l              7\n")
    f.write("\n") 
    f.write("/*** Lattice ***/\n")
    f.write("lat 701  1  0.0 0.0 "+str(number_fuel)+" "+str(number_fuel)+"  "+ str_(pitch_fuel)+"\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 G0 F8 F8 F8 F8 F8 F8 F8 F8 F8 G0 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 G0 F8 F8 F8 F8 F8 F8 F8 F8 F8 G0 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 G0 F8 F8 G0 F8 F8 G0 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8\n")
    f.write("\n") 
    f.write("cell A300 C03 fill 701 -9\n")   
    f.write("cell A301 C03 water  9\n")   
    f.write("\n")  
    f.write("/************************\n")
    f.write(" * Core Configuration\n")
    f.write(" ************************/\n")
    f.write("lat core1 1 0.0 0.0 "+str(number_assembly)+" "+str(number_assembly)+"  "+str_(length)+"\n")
    f.write(" HHH HHH C01 B02 C01 HHH HHH \n")
    f.write(" HHH C02 B01 A01 B01 C02 HHH \n")
    f.write(" C01 B01 A02 A01 A02 B01 C01 \n")
    f.write(" B02 A01 A01 C03 A01 A01 B02 \n")
    f.write(" C01 B01 A02 A01 A02 B01 C01 \n")
    f.write(" HHH C02 B01 A01 B01 C02 HHH \n")
    f.write(" HHH HHH C01 B02 C01 HHH HHH \n")
    f.write("\n")
    f.write("cell EC018 CORE fill core1  -21\n")
    f.write("cell EC019 CORE ss304l      21\n")
    f.write("\n")
    f.write("cell 8 0 fill CORE    -22\n")
    f.write("cell 9 0 ss304         22 -23\n")
    f.write("cell 10 0 water        23 -24\n")
    f.write("cell 11 0 ss508        24 -25\n")
    f.write("cell 12 0 outside        25  \n")
    f.write("cell E015 HHH ss304l  -11\n")
    f.write("\n")
    f.write("\n")
    f.write("/**Plot Graphs*/\n")
    f.write("plot 3 5000 5000\n")
    f.write("mesh 3 5000 5000\n")
    f.write("plot 2 1500 5000\n")
    f.write("set print 1\n")
    f.write("set opti 1\n")
    f.write("\n") 
    f.write("/***Run Parameters***/\n")
    f.write("\n") 
    f.write(f"set pop {pop} {cyc} {incyc}\n")
    f.write(f"set bc {bc}\n")
    f.write(f"set power {power}\n")
    f.write(f"set title \"nuscale-{ind+1}\"\n")
    f.write("\n") 
    f.write("/****Cross Section Library***/\n")
    f.write(f"set acelib \"{filepath1}\"\n") 
    f.write(f"set declib \"{filepath2}\"\n")
    f.write(f"set nfylib \"{filepath3}\"\n")
    f.write("\n") 
    f.write("/*** Moviment bar control***/\n")
    f.write("trans u G0 0 0 0\n")
    f.write("trans u BC 0 0 10\n")
    f.write("/*** Reproductibility***/\n")
    f.write("set repro 2\n")
    f.write("\n")
    f.write("/*** Calculating material volumes***/\n")
    f.write("set mcvol 100000000 \n")

print(f"Os arquivos criados e deverao ser rodados dessa forma\n")
print(f"./sss2 -omp 12 -checkvolumes 100000000 nuscale_"+str(ind)+"o.c ;./sss2 -omp 12 nuscale_"+str(ind)+"d.c  ;./sss2 -omp 12 nuscale_"+str(ind)+"h.c \n")

variables = {
    "Parameters Design": "Units[cm] ",
    "total_heigth": total_heigth,
    "radius": radius_fuel,
    "number_fuel": number_fuel,
    "pitch_fuel": pitch_fuel,
    "heigth_active": heigth_active,
    "diameter_fuel": 2*(radius_fuel),
    "gap": gap,
    "clad": clad,
    "top_nozzle": top_nozzle,
    "coolant": coolant,
    "end_cap": end_cap,
    "plenum_spring": plenum_spring,
    "spring": spring,
    "bottom_nozzle": bottom_nozzle,
    "number_assembly": number_assembly,
    "empty_guide": empty_guide,
    "end_plug": end_plug,
    "length_aic": length_aic,
    "length_b4c": length_b4c,
    "upper_plenum": upper_plenum,
    "radius_aic": radius_aic,
    "radius_b4c": radius_b4c,
    "radius_bar": radius_bar,
    "ratio_fuel": ratio_fuel,
    "length": length,
    "vol_fuel": vol_fuel,
    "vol_sub_fuel": vol_sub_fuel,
    "vol_fuel_mod": vol_fuel_mod,
    "ratio_vm_vf_fuel": ratio_vm_vf_fuel,
    "square_barrel": square_barrel,
    "core_barrel_id": core_barrel_id,
    "core_barrel_od": core_barrel_od,
    "rpv_id": rpv_id,
    "rpv_od": rpv_od
}

# Transferência dos arquivos para a pasta de destino
transfer_file(f"{filepath6}nuscale_0o.c", f"{filepath5}nuscale_0o.c")
transfer_file(f"{filepath6}nuscale_0d.c", f"{filepath5}nuscale_0d.c")
transfer_file(f"{filepath6}nuscale_0h.c", f"{filepath5}nuscale_0h.c")

with open(f'{filepath6}design_nuscale.csv', mode='w', newline='') as file:
    writer = csv.writer(file)
    writer.writerow(["Variable", "Value"])
    for key, value in variables.items():
        writer.writerow([key, value])


################################################################################################
################################################################################################
